extends ../../layouts/default.pug
block styles
    link(rel="stylesheet", href="/css/playlist.css")
block main
    .container.mt-4
        .d-flex.justify-content-between.align-items-center.mb-4
            h2.text-primary.font-weight-bold Playlists của bạn
            button.btn.btn-success.btn-lg.rounded-pill(
                type="button",
                onclick="openCreatePlaylistModal()"
            )
                i.fa-solid.fa-plus.mr-1
                |  Tạo Playlist
        if playlists && playlists.length
            .playlist-grid.row
                each playlist in playlists
                    .col-lg-3.col-md-4.col-sm-6.mb-4
                        .playlist-card.shadow-sm(
                            style="cursor:pointer;",
                            onclick=`window.location.href='/playlists/${playlist._id}'`
                        )
                            .thumbnail-wrapper.position-relative
                                if playlist.thumbnail
                                    img.thumbnail(src=playlist.thumbnail, alt=playlist.title)
                                else
                                    img.thumbnail(src="https://via.placeholder.com/400x400?text=Playlist", alt="Thumbnail")
                                .play-btn(onclick=`event.stopPropagation(); playPlaylist('${playlist._id}')`)
                                    i.fa-solid.fa-play

                            .info.mt-2
                                h5.title.text-dark.font-weight-bold #{playlist.title}
                                small.text-muted #{playlist.tracks.length || 0} bài hát

                            .actions.mt-2.d-flex.justify-content-between
                                a.btn.btn-outline-primary.btn-sm.rounded-pill(
                                    href=`/playlists/edit/${playlist._id}`,
                                    onclick="event.stopPropagation();"
                                ) 
                                    i.fa-solid.fa-pen
                                form(action=`/playlists/delete/${playlist._id}` method="POST", onsubmit="event.stopPropagation();")
                                    button.btn.btn-outline-danger.btn-sm.rounded-pill(
                                        type="submit",
                                        onclick="return confirm('Xóa playlist này?')"
                                    )
                                        i.fa-solid.fa-trash


        else
            .text-center.mt-5.text-muted
                i.fa-solid.fa-music.fa-3x.mb-3
                p Chưa có playlist nào — hãy tạo playlist đầu tiên của bạn!
    div#createPlaylistModal.modal-overlay(style="display:none;")
        .modal-box
            .modal-header
                h5.modal-title Tạo Playlist
                button.close(type="button", onclick="closeCreatePlaylistModal()") ×

            .modal-body
                label(for="playlistName") Tên playlist
                input#playlistName.form-control(type="text", placeholder="Nhập tên playlist...")

            .modal-footer
                button.btn.btn-secondary.rounded-pill(type="button", onclick="closeCreatePlaylistModal()") Cancel
                button.btn.btn-primary.rounded-pill(type="button", onclick="savePlaylist()") Save
block scripts
    script(src="/js/playlist.js")
